<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.text.Font?>

<VBox xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml" fx:controller="com.esprit.controllers.AfficherEvent"
      styleClass="main-container" stylesheets="@../styles/home.css">

    <!-- Header Section -->
    <HBox styleClass="header" alignment="CENTER_LEFT" spacing="20">
        <padding>
            <Insets top="15" right="25" bottom="15" left="25"/>
        </padding>
        
        <ImageView fitHeight="50" fitWidth="120" preserveRatio="true">
            <Image url="@../images/logo.png"/>
        </ImageView>
        
        <HBox spacing="25" alignment="CENTER" HBox.hgrow="ALWAYS" styleClass="nav-container">
            <Button text="Home" styleClass="nav-button" onAction="#navigateToHome"/>
            
            <!-- Add a direct Polls button to the main navbar -->
            <Button text="Polls" styleClass="nav-button" onAction="#navigateToClubPolls"/>
            
            <!-- Clubs dropdown container -->
            <StackPane fx:id="clubsContainer" styleClass="nav-dropdown-container" onMouseExited="#hideClubsDropdown">
                <Button fx:id="clubsButton" text="Clubs" styleClass="nav-button" onMouseEntered="#showClubsDropdown"/>
                
                <!-- Clubs Dropdown Menu - Initially hidden -->
                <VBox fx:id="clubsDropdown" styleClass="nav-dropdown-menu" visible="false" managed="false" onMouseEntered="#showClubsDropdown">
                    <HBox fx:id="clubMembersItem" styleClass="dropdown-item" onMouseClicked="#navigateToClubs">
                        <Label text="👥" styleClass="dropdown-item-icon"/>
                        <Label text="Club Management" styleClass="dropdown-item-text"/>
                    </HBox>
                    <Separator styleClass="dropdown-divider"/>
                    <HBox styleClass="dropdown-item" onMouseClicked="#navigateToMyClub">
                        <Label text="🏆" styleClass="dropdown-item-icon"/>
                        <Label text="My Club" styleClass="dropdown-item-text"/>
                    </HBox>
                </VBox>
            </StackPane>
            
            <Button text="Events" styleClass="nav-button-selected"/>
            <Button text="Products" styleClass="nav-button" onAction="#navigateToProducts"/>
            <Button text="Competition" styleClass="nav-button" onAction="#navigateToCompetition"/>
        </HBox>
        
        <HBox spacing="15" alignment="CENTER_RIGHT">
            <!-- User Profile Section -->
            <StackPane fx:id="userProfileContainer" styleClass="user-profile-container" onMouseEntered="#showProfileDropdown" onMouseExited="#hideProfileDropdown">
                <HBox spacing="10" alignment="CENTER" styleClass="user-profile-content">
                    <ImageView fx:id="userProfilePic" fitHeight="45" fitWidth="45" styleClass="profile-pic">
                        <Image url="@../images/default-profile.png"/>
                    </ImageView>
                    <Label fx:id="userNameLabel" text="John Doe" styleClass="user-name"/>
                </HBox>
                
                <!-- Dropdown Menu -->
                <VBox fx:id="profileDropdown" styleClass="profile-dropdown" visible="false" managed="false">
                    <Button text="My Profile" styleClass="dropdown-item" onAction="#navigateToProfile"/>
                    <Separator styleClass="dropdown-divider"/>
                    <Button text="Logout" styleClass="dropdown-item" onAction="#handleLogout"/>
                </VBox>
            </StackPane>
            
            <Button text="Contact Us" styleClass="contact-button" onAction="#navigateToContact"/>
        </HBox>
    </HBox>

    <!-- Event Filter and Controls -->
    <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: white; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 5);">
        <!-- Search Box -->
        <TextField fx:id="searchField" prefWidth="300" promptText="Search events..." style="-fx-background-color: white; -fx-background-radius: 20; -fx-border-color: #dddddd; -fx-border-radius: 20; -fx-padding: 8 15;">
            <font>
                <Font name="Arial" size="14" />
            </font>
        </TextField>

        <!-- Category Filter -->
        <ComboBox fx:id="categoryFilter" prefWidth="180" promptText="Category" style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #dddddd; -fx-border-radius: 8; -fx-padding: 8;">
        </ComboBox>

        <!-- Club Filter -->
        <ComboBox fx:id="clubFilter" prefWidth="180" promptText="Club" style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #dddddd; -fx-border-radius: 8; -fx-padding: 8;">
        </ComboBox>

        <!-- Date Filter -->
        <ComboBox fx:id="dateFilter" prefWidth="180" promptText="Date" style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #dddddd; -fx-border-radius: 8; -fx-padding: 8;">
            <tooltip>
                <Tooltip text="Filter by date" />
            </tooltip>
        </ComboBox>

        <HBox alignment="CENTER_RIGHT" HBox.hgrow="ALWAYS" spacing="15">
            <Button fx:id="addNewEventButton" onAction="#handleAddNewEvent" style="-fx-background-color: #1e90ff; -fx-text-fill: white; -fx-background-radius: 20; -fx-padding: 8 15;" text="Add New Event">
                <font>
                    <Font name="Arial Bold" size="14" />
                </font>
                <effect>
                    <DropShadow color="#00000033" radius="5" spread="0.05" />
                </effect>
            </Button>
        </HBox>
    </HBox>

    <!-- Main Content -->
    <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="content-scroll">
        <FlowPane fx:id="eventsContainer" hgap="25" style="-fx-padding: 25; -fx-background-color: #f8f9fa;" vgap="25">
            <!-- Event cards will be added here dynamically -->
        </FlowPane>
    </ScrollPane>

    <!-- Footer -->
    <BorderPane style="-fx-background-color: #f8f9fa; -fx-padding: 15;">
        <left>
            <Label style="-fx-text-fill: #666666;" text="© 2025 - Club Event Management">
                <font>
                    <Font name="Arial" size="12" />
                </font>
            </Label>
        </left>
        <right>
            <HBox alignment="CENTER_RIGHT" spacing="15">
                <Label fx:id="totalEventsLabel" style="-fx-text-fill: #666666;" text="Total Events: 24">
                    <font>
                        <Font name="Arial" size="12" />
                    </font>
                </Label>
                <Label style="-fx-text-fill: #666666;" text="Page 1 of 3">
                    <font>
                        <Font name="Arial" size="12" />
                    </font>
                </Label>
                <HBox alignment="CENTER" spacing="5">
                    <Button style="-fx-background-color: #dddddd; -fx-text-fill: #333333; -fx-background-radius: 3; -fx-padding: 3 8;" text="&lt;">
                        <font>
                            <Font name="Arial Bold" size="12" />
                        </font>
                    </Button>
                    <Button style="-fx-background-color: #1e90ff; -fx-text-fill: white; -fx-background-radius: 3; -fx-padding: 3 8;" text="1">
                        <font>
                            <Font name="Arial Bold" size="12" />
                        </font>
                    </Button>
                    <Button style="-fx-background-color: #dddddd; -fx-text-fill: #333333; -fx-background-radius: 3; -fx-padding: 3 8;" text="2">
                        <font>
                            <Font name="Arial Bold" size="12" />
                        </font>
                    </Button>
                    <Button style="-fx-background-color: #dddddd; -fx-text-fill: #333333; -fx-background-radius: 3; -fx-padding: 3 8;" text="3">
                        <font>
                            <Font name="Arial Bold" size="12" />
                        </font>
                    </Button>
                    <Button style="-fx-background-color: #dddddd; -fx-text-fill: #333333; -fx-background-radius: 3; -fx-padding: 3 8;" text="&gt;">
                        <font>
                            <Font name="Arial Bold" size="12" />
                        </font>
                    </Button>
                </HBox>
            </HBox>
        </right>
    </BorderPane>
</VBox>
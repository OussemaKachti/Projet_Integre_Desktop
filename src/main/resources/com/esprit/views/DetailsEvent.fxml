<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.effect.ColorAdjust?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.shape.Line?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.geometry.Insets?>
<?import java.lang.String?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Tooltip?>

<AnchorPane prefHeight="700.0" prefWidth="1000.0" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.esprit.controllers.DetailsEvent">

    <StackPane AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
        <!-- Main background with enhanced gradient -->
        <BorderPane style="-fx-background-color: linear-gradient(to bottom right, #f5f9ff, #e6f0ff);">

            <!-- Enhanced Header with better spacing and icons -->
            <top>
                <BorderPane style="-fx-background-color: linear-gradient(to right, #1a237e, #3949ab); -fx-padding: 20;">
                    <left>
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Label text="ðŸ“†" textFill="WHITE">
                                <font>
                                    <Font size="26" />
                                </font>
                            </Label>
                            <Label text="Event Details" textFill="WHITE">
                                <font>
                                    <Font name="Arial Bold" size="30" />
                                </font>
                            </Label>
                        </HBox>
                    </left>
                    <right>
                        <HBox alignment="CENTER_RIGHT" spacing="15">
                            <Button fx:id="backButton" onAction="#handleBack" style="-fx-background-color: rgba(255,255,255,0.25); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.5); -fx-border-width: 1; -fx-border-radius: 20; -fx-background-radius: 20; -fx-padding: 10 20; -fx-cursor: hand;" text="â† Retour">
                                <font>
                                    <Font name="Arial Bold" size="14" />
                                </font>
                                <effect>
                                    <DropShadow color="#00000066" radius="5" spread="0.02" />
                                </effect>
                            </Button>
                        </HBox>
                    </right>
                    <effect>
                        <DropShadow color="#00000066" radius="10" spread="0.05" />
                    </effect>
                </BorderPane>
            </top>

            <!-- Main content -->
            <center>
                <ScrollPane fitToWidth="true" style="-fx-background-color: transparent; -fx-background: transparent; -fx-border-color: transparent;">
                    <BorderPane style="-fx-padding: 30;">
                        <center>
                            <VBox spacing="35">
                                <!-- Enhanced Event Image and Title Section with improved shadows -->
                                <StackPane>
                                    <!-- Hero Image Container with Enhanced Shadow -->
                                    <BorderPane style="-fx-background-color: white; -fx-background-radius: 18; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.35), 25, 0, 0, 7);">
                                        <!-- Image with Clip Path for rounded corners -->
                                        <center>
                                            <StackPane>
                                                <!-- Rectangle clip for the image -->
                                                <ImageView fx:id="eventImageView" fitHeight="400.0" fitWidth="960.0" preserveRatio="true">
                                                    <effect>
                                                        <ColorAdjust brightness="-0.05" contrast="0.15" saturation="0.1" />
                                                    </effect>
                                                    <clip>
                                                        <Rectangle width="960.0" height="400.0" arcWidth="18.0" arcHeight="18.0" />
                                                    </clip>
                                                </ImageView>

                                                <!-- Subtle image border highlight -->
                                                <Rectangle width="960.0" height="400.0" arcWidth="18.0" arcHeight="18.0" fill="transparent"
                                                           stroke="#ffffff44" strokeWidth="2.0" />

                                                <!-- Enhanced image overlay gradient -->
                                                <Rectangle width="960.0" height="400.0" arcWidth="18.0" arcHeight="18.0"
                                                           style="-fx-fill: linear-gradient(to bottom,
                                                                  rgba(0,0,0,0.0) 0%,
                                                                  rgba(0,0,0,0.0) 40%,
                                                                  rgba(0,0,0,0.3) 70%,
                                                                  rgba(0,0,0,0.7) 100%);" />
                                            </StackPane>
                                        </center>

                                        <!-- Enhanced Event Title Overlay with better gradient and positioning -->
                                        <bottom>
                                            <StackPane>
                                                <VBox spacing="20" style="-fx-background-color: linear-gradient(from 0% 0% to 0% 100%, transparent, rgba(0,0,0,0.90)); -fx-padding: 45 45 50 45;">
                                                    <!-- Enhanced title with better text effects -->
                                                    <Label fx:id="eventTitleLabel" textFill="WHITE" wrapText="true" style="-fx-font-smoothing-type: lcd;">
                                                        <font>
                                                            <Font name="Arial Bold" size="42" />
                                                        </font>
                                                        <effect>
                                                            <DropShadow color="#000000cc" radius="4" spread="0.15" offsetX="0" offsetY="1" />
                                                        </effect>
                                                    </Label>

                                                    <!-- Enhanced category display with animation prep -->
                                                    <HBox alignment="CENTER_LEFT" spacing="20">
                                                        <!-- Event Type Badge with enhanced styling -->
                                                        <Label fx:id="eventTypeLabel"
                                                               style="-fx-background-color: linear-gradient(to right, #1565C0, #42a5f5);
                                                                      -fx-background-radius: 24;
                                                                      -fx-padding: 9 24;
                                                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 2);"
                                                               textFill="WHITE">
                                                            <font>
                                                                <Font name="Arial Bold" size="16" />
                                                            </font>
                                                            <!-- Optional: Add hover effect with JavaFX CSS -->
                                                            <styleClass>
                                                                <String fx:value="badge-hover" />
                                                            </styleClass>
                                                        </Label>

                                                        <!-- Event Category Badge with enhanced styling -->
                                                        <Label fx:id="eventCategoryLabel"
                                                               style="-fx-background-color: linear-gradient(to right, #2e7d32, #66bb6a);
                                                                      -fx-background-radius: 24;
                                                                      -fx-padding: 9 24;
                                                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 2);"
                                                               textFill="WHITE">
                                                            <font>
                                                                <Font name="Arial Bold" size="16" />
                                                            </font>
                                                        </Label>
                                                    </HBox>
                                                </VBox>
                                            </StackPane>
                                        </bottom>
                                    </BorderPane>
                                </StackPane>

                                <!-- Event Information Section - Reorganized -->
                                <HBox spacing="30">
                                    <!-- Left Column - Details -->
                                    <VBox spacing="25" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 18; -fx-padding: 35; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 12, 0, 0, 3);">
                                        <!-- Event Description with improved typography -->
                                        <VBox spacing="15">
                                            <HBox alignment="CENTER_LEFT" spacing="12">
                                                <Label text="ðŸ“" style="-fx-text-fill: #3949ab;">
                                                    <font>
                                                        <Font size="22" />
                                                    </font>
                                                </Label>
                                                <Label style="-fx-text-fill: #333333;" text="About This Event">
                                                    <font>
                                                        <Font name="Arial Bold" size="24" />
                                                    </font>
                                                </Label>
                                            </HBox>
                                            <Line startX="0" endX="600" style="-fx-stroke: #e0e0e0; -fx-stroke-width: 1.5;" />
                                            <Label fx:id="eventDescriptionLabel" style="-fx-text-fill: #444444; -fx-line-height: 1.6;" wrapText="true">
                                                <font>
                                                    <Font name="Arial" size="16" />
                                                </font>
                                                <VBox.margin>
                                                    <Insets top="5" />
                                                </VBox.margin>
                                            </Label>
                                        </VBox>

                                        <!-- Host Information with improved styling -->
                                        <VBox spacing="15">
                                            <HBox alignment="CENTER_LEFT" spacing="12">
                                                <Label text="ðŸ‘¥" style="-fx-text-fill: #3949ab;">
                                                    <font>
                                                        <Font size="20" />
                                                    </font>
                                                </Label>
                                                <Label style="-fx-text-fill: #333333;" text="Hosted By">
                                                    <font>
                                                        <Font name="Arial Bold" size="22" />
                                                    </font>
                                                </Label>
                                            </HBox>
                                            <Line startX="0" endX="600" style="-fx-stroke: #e0e0e0; -fx-stroke-width: 1.5;" />
                                            <HBox alignment="CENTER_LEFT" spacing="20">
                                                <VBox spacing="8">
                                                    <Label fx:id="clubNameLabel" style="-fx-text-fill: #333333;">
                                                        <font>
                                                            <Font name="Arial Bold" size="20" />
                                                        </font>
                                                    </Label>
                                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                                        <Label text="ðŸ†" style="-fx-text-fill: #4caf50;">
                                                            <font>
                                                                <Font size="16" />
                                                            </font>
                                                        </Label>
                                                        <Label style="-fx-text-fill: #666666;" text="Official Event Organizer">
                                                            <font>
                                                                <Font name="Arial" size="15" />
                                                            </font>
                                                        </Label>
                                                    </HBox>
                                                </VBox>
                                            </HBox>
                                        </VBox>

                                        <!-- Share Button for All Users (moved from bottom) -->
                                        <Button fx:id="shareButton" style="-fx-background-color: linear-gradient(to right, #2e7d32, #43a047); -fx-text-fill: white; -fx-background-radius: 25; -fx-padding: 14 25; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 5, 0, 0, 2); -fx-cursor: hand;" text="ðŸ”— Partager l'Ã©vÃ©nement">
                                            <font>
                                                <Font name="Arial Bold" size="15" />
                                            </font>
                                            <VBox.margin>
                                                <Insets top="15" />
                                            </VBox.margin>
                                        </Button>
                                    </VBox>

                                    <!-- Right Column - Event Details & Actions -->
                                    <VBox spacing="25" prefWidth="350">
                                        <!-- Event Details Panel with improved spacing -->
                                        <VBox spacing="20" style="-fx-background-color: white; -fx-background-radius: 18; -fx-padding: 30; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 12, 0, 0, 3);">
                                            <HBox alignment="CENTER_LEFT" spacing="12">
                                                <Label text="ðŸ“‹" style="-fx-text-fill: #3949ab;">
                                                    <font>
                                                        <Font size="20" />
                                                    </font>
                                                </Label>
                                                <Label style="-fx-text-fill: #333333;" text="Event Details">
                                                    <font>
                                                        <Font name="Arial Bold" size="22" />
                                                    </font>
                                                </Label>
                                            </HBox>
                                            <Line startX="0" endX="300" style="-fx-stroke: #e0e0e0; -fx-stroke-width: 1.5;" />

                                            <!-- Date & Time with improved icons -->
                                            <VBox spacing="12">
                                                <Label style="-fx-text-fill: #555555;" text="Date &amp; Time">
                                                    <font>
                                                        <Font name="Arial Bold" size="16" />
                                                    </font>
                                                </Label>
                                                <HBox spacing="15" alignment="CENTER_LEFT">
                                                    <StackPane>
                                                        <BorderPane style="-fx-background-color: #e3f2fd; -fx-background-radius: 10; -fx-min-width: 44; -fx-min-height: 44; -fx-max-width: 44; -fx-max-height: 44; -fx-alignment: center;">
                                                            <center>
                                                                <Label text="ðŸ“…" style="-fx-text-fill: #1976d2;">
                                                                    <font>
                                                                        <Font size="20" />
                                                                    </font>
                                                                </Label>
                                                            </center>
                                                        </BorderPane>
                                                    </StackPane>
                                                    <VBox spacing="6">
                                                        <Label fx:id="startDateLabel" style="-fx-text-fill: #333333;">
                                                            <font>
                                                                <Font name="Arial Bold" size="16" />
                                                            </font>
                                                        </Label>
                                                        <Label fx:id="endDateLabel" style="-fx-text-fill: #555555;">
                                                            <font>
                                                                <Font name="Arial" size="15" />
                                                            </font>
                                                        </Label>
                                                    </VBox>
                                                </HBox>
                                            </VBox>

                                            <!-- Location with improved icons -->
                                            <VBox spacing="12">
                                                <Label style="-fx-text-fill: #555555;" text="Location">
                                                    <font>
                                                        <Font name="Arial Bold" size="16" />
                                                    </font>
                                                </Label>
                                                <HBox spacing="15" alignment="CENTER_LEFT">
                                                    <StackPane>
                                                        <BorderPane style="-fx-background-color: #e8f5e9; -fx-background-radius: 10; -fx-min-width: 44; -fx-min-height: 44; -fx-max-width: 44; -fx-max-height: 44; -fx-alignment: center;">
                                                            <center>
                                                                <Label text="ðŸ“" style="-fx-text-fill: #43a047;">
                                                                    <font>
                                                                        <Font size="20" />
                                                                    </font>
                                                                </Label>
                                                            </center>
                                                        </BorderPane>
                                                    </StackPane>
                                                    <Label fx:id="locationLabel" style="-fx-text-fill: #333333;" wrapText="true">
                                                        <font>
                                                            <Font name="Arial" size="16" />
                                                        </font>
                                                    </Label>
                                                </HBox>
                                            </VBox>

                                            <!-- Register Button with improved styling -->
                                            <Button fx:id="registerButton" style="-fx-background-color: linear-gradient(to right, #1976d2, #2979ff); -fx-text-fill: white; -fx-background-radius: 25; -fx-padding: 16 22; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 2); -fx-cursor: hand;" text="âœ“ S'inscrire Ã  l'Ã©vÃ©nement">
                                                <VBox.margin>
                                                    <Insets top="15" />
                                                </VBox.margin>
                                                <font>
                                                    <Font name="Arial Bold" size="16" />
                                                </font>
                                            </Button>

                                            <!-- Participant Button to Generate QR Code -->
                                            <Button fx:id="qrCodeButton" mnemonicParsing="false"
                                                    style="-fx-background-color: linear-gradient(to right, #4a148c, #7b1fa2); -fx-text-fill: white; -fx-background-radius: 25; -fx-padding: 16 22; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 2); -fx-cursor: hand;"
                                                    text="ðŸ”³ GÃ©nÃ©rer QR Code">
                                                <tooltip>
                                                    <Tooltip text="GÃ©nÃ©rer un QR code pour confirmer votre participation" />
                                                </tooltip>
                                                <VBox.margin>
                                                    <Insets top="10" />
                                                </VBox.margin>
                                                <font>
                                                    <Font name="Arial Bold" size="16" />
                                                </font>
                                            </Button>
                                        </VBox>

                                        <!-- Admin Actions Panel (renamed from President) -->
                                        <VBox spacing="20" style="-fx-background-color: white; -fx-background-radius: 18; -fx-padding: 30; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 12, 0, 0, 3);">
                                            <HBox alignment="CENTER_LEFT" spacing="12">
                                                <Label text="ðŸ‘‘" style="-fx-text-fill: #ff6f00;">
                                                    <font>
                                                        <Font size="20" />
                                                    </font>
                                                </Label>
                                                <Label style="-fx-text-fill: #333333;" text="Actions Administrateur">
                                                    <font>
                                                        <Font name="Arial Bold" size="22" />
                                                    </font>
                                                </Label>
                                            </HBox>
                                            <Line startX="0" endX="300" style="-fx-stroke: #e0e0e0; -fx-stroke-width: 1.5;" />

                                            <!-- Note about admin privileges -->
                                            <VBox spacing="5">
                                                <Label style="-fx-text-fill: #666666;" text="Actions rÃ©servÃ©es aux administrateurs du club" wrapText="true">
                                                    <font>
                                                        <Font name="Arial Italic" size="14" />
                                                    </font>
                                                </Label>
                                            </VBox>

                                            <!-- Reorganized Admin Actions -->
                                            <VBox spacing="15">
                                                <!-- Event Management Section -->
                                                <Label style="-fx-text-fill: #555555;" text="Gestion de l'Ã©vÃ©nement">
                                                    <font>
                                                        <Font name="Arial Bold" size="16" />
                                                    </font>
                                                </Label>

                                                <!-- Update Button -->
                                                <Button fx:id="editButton" onAction="#handleEdit" style="-fx-background-color: linear-gradient(to right, #e65100, #f57c00); -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 12 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 1); -fx-cursor: hand;">
                                                    <graphic>
                                                        <HBox spacing="10" alignment="CENTER">
                                                            <Label text="ðŸ”„" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font size="16" />
                                                                </font>
                                                            </Label>
                                                            <Label text="Modifier l'Ã©vÃ©nement" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font name="Arial Bold" size="15" />
                                                                </font>
                                                            </Label>
                                                        </HBox>
                                                    </graphic>
                                                </Button>

                                                <!-- Delete Button -->
                                                <Button fx:id="presidentButton1" style="-fx-background-color: #D32F2F; -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 12 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 1); -fx-cursor: hand;">
                                                    <graphic>
                                                        <HBox spacing="10" alignment="CENTER">
                                                            <Label text="ðŸ—‘ï¸" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font size="16" />
                                                                </font>
                                                            </Label>
                                                            <Label text="Supprimer l'Ã©vÃ©nement" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font name="Arial Bold" size="15" />
                                                                </font>
                                                            </Label>
                                                        </HBox>
                                                    </graphic>
                                                </Button>

                                                <Separator style="-fx-background-color: #e0e0e0; -fx-opacity: 0.7;" />

                                                <!-- Participant Management Section -->
                                                <Label style="-fx-text-fill: #555555;" text="Gestion des participants">
                                                    <font>
                                                        <Font name="Arial Bold" size="16" />
                                                    </font>
                                                </Label>

                                                <!-- View Participants Button -->
                                                <Button fx:id="presidentButton3" style="-fx-background-color: linear-gradient(to right, #6a1b9a, #8e24aa); -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 12 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 1); -fx-cursor: hand;">
                                                    <graphic>
                                                        <HBox spacing="10" alignment="CENTER">
                                                            <Label text="ðŸ‘¥" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font size="16" />
                                                                </font>
                                                            </Label>
                                                            <Label text="Liste des participants" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font name="Arial Bold" size="15" />
                                                                </font>
                                                            </Label>
                                                        </HBox>
                                                    </graphic>
                                                </Button>

                                                <!-- QR Code Scanner (moved to admin section) -->
                                                <Button fx:id="scanQrCodeButton" mnemonicParsing="false"
                                                        style="-fx-background-color: linear-gradient(to right, #bf360c, #e64a19); -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 12 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 1); -fx-cursor: hand;">
                                                    <graphic>
                                                        <HBox spacing="10" alignment="CENTER">
                                                            <Label text="ðŸ”" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font size="16" />
                                                                </font>
                                                            </Label>
                                                            <Label text="Scanner QR Codes" style="-fx-text-fill: white;">
                                                                <font>
                                                                    <Font name="Arial Bold" size="15" />
                                                                </font>
                                                            </Label>
                                                        </HBox>
                                                    </graphic>
                                                    <tooltip>
                                                        <Tooltip text="Scanner les QR codes des participants (rÃ©servÃ© aux organisateurs)" />
                                                    </tooltip>
                                                </Button>
                                            </VBox>

                                            <!-- Improved status indicator -->
                                            <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 15 0 0 0;">
                                                <Label text="ðŸ”’" style="-fx-text-fill: #d32f2f;">
                                                    <font>
                                                        <Font size="14" />
                                                    </font>
                                                </Label>
                                                <Label style="-fx-text-fill: #666666;" text="AccÃ¨s administrateur uniquement" wrapText="true">
                                                    <font>
                                                        <Font name="Arial Italic" size="13" />
                                                    </font>
                                                </Label>
                                            </HBox>
                                        </VBox>
                                    </VBox>
                                </HBox>
                            </VBox>
                        </center>
                    </BorderPane>
                </ScrollPane>
            </center>

            <!-- Improved Footer -->
            <bottom>
                <HBox alignment="CENTER" style="-fx-background-color: #f8f9fa; -fx-padding: 18; -fx-border-color: #eeeeee; -fx-border-width: 1 0 0 0;">
                    <Label style="-fx-text-fill: #666666;" text="Â© 2025 - Club Event Management System">
                        <font>
                            <Font name="Arial" size="13" />
                        </font>
                    </Label>
                </HBox>
            </bottom>
        </BorderPane>
    </StackPane>
</AnchorPane>